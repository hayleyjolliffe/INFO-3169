-- HAYLEY JOLLIFFE
-- Week 11

-- Step 1
DROP VIEW IF EXISTS [Step 1];

CREATE VIEW [Step 1] AS
SELECT FIRST_NAME, LAST_NAME
FROM employees
WHERE DEPARTMENT_ID = (SELECT DEPARTMENT_ID
                        FROM departments
                        WHERE DEPARTMENT_NAME = 'Finance'
                        OR DEPARTMENT_NAME = 'Sales');

-- Step 2
DROP VIEW IF EXISTS [Step 2];

CREATE VIEW [Step 2] AS
SELECT FIRST_NAME, LAST_NAME, SALARY
FROM employees
WHERE SALARY > (SELECT SALARY
                FROM employees
                WHERE LAST_NAME = 'Russell');

-- Step 3
DROP VIEW IF EXISTS [Step 3];

CREATE VIEW [Step 3] AS
SELECT e1.FIRST_NAME, e1.LAST_NAME, e1.HIRE_DATE
FROM employees e1
JOIN employees e2 ON e2.LAST_NAME = 'Russell'
WHERE e1.HIRE_DATE > e2.HIRE_DATE;

-- Step 4
DROP VIEW IF EXISTS [Step 4];

CREATE VIEW [Step 4] AS
SELECT l.LOCATION_ID, l.STREET_ADDRESS, l.CITY, l.STATE_PROVINCE, c.COUNTRY_NAME
FROM locations l
JOIN countries c ON l.COUNTRY_ID = c.COUNTRY_ID;

-- Step 5
DROP VIEW IF EXISTS [Step 5];

CREATE VIEW [Step 5] AS
SELECT SUM(SALARY) AS TOTAL_SALARY
FROM employees
WHERE TOTAL_SALARY < 60000
GROUP BY DEPARTMENT_ID;

-- Step 6
DROP VIEW IF EXISTS [Step 6];

CREATE VIEW [Step 6] AS
SELECT MAX(SALARY) AS HIGHEST_SALARY, MIN(SALARY) AS LOWEST_SALARY, SUM(SALARY) AS TOTAL_SALARY, AVG(SALARY) AS AVERAGE_SALARY
FROM employees
WHERE DEPARTMENT_ID = 50;

-- Step 7
SELECT LAST_DAY("2013-02-01");

-- Step 8
SELECT DATEDIFF(day, '2011-09-08', '2011-09-17') AS DAYS_BETWEEN;

-- Step 9

-- Step 10
